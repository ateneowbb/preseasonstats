<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ateneo Blue Eagles Basketball Stats</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
            color: #e2e8f0;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Navigation */
        .nav {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(59, 130, 246, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 800;
            color: #3b82f6;
        }
        
        .nav-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            background: rgba(59, 130, 246, 0.1);
            color: #e2e8f0;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .nav-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.3);
            transform: translateY(-1px);
        }
        
        .nav-btn.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
        }
        
        /* Hero Section */
        .hero {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(29, 78, 216, 0.05));
            border-radius: 20px;
            margin: 2rem 0;
            border: 1px solid rgba(59, 130, 246, 0.1);
        }
        
        .hero-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
        }
        
        .eagle-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.3);
        }
        
        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero p {
            color: #e2e8f0;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .motto {
            color: #e2e8f0;
            font-style: italic;
            font-size: 0.95rem;
        }
        
        /* Cards */
        .card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        /* Form Elements */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-label {
            font-weight: 600;
            color: #3b82f6;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-input, .form-select {
            padding: 12px 16px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            background: rgba(15, 23, 42, 0.8);
            color: #e2e8f0;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            transition: all 0.3s ease;
            outline: none;
        }
        
        .form-input:focus, .form-select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        .form-input::placeholder {
            color: #94a3b8;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(59, 130, 246, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #1e293b, #334155);
            color: #e2e8f0;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #334155, #475569);
            border-color: rgba(59, 130, 246, 0.4);
            transform: translateY(-1px);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #d97706, #b45309);
            color: white;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 0.8rem;
        }
        
        /* Stats Table */
        .table-container {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(59, 130, 246, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8rem;
        }
        
        .stats-table th {
            background: linear-gradient(135deg, #1e3a8a, #1d4ed8);
            color: white;
            padding: 12px 8px;
            font-weight: 600;
            text-align: center;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .stats-table td {
            padding: 8px;
            border: 1px solid rgba(59, 130, 246, 0.1);
            text-align: center;
        }
        
        .player-row {
            background: rgba(15, 23, 42, 0.5);
            transition: all 0.3s ease;
        }
        
        .player-row:nth-child(even) {
            background: rgba(30, 41, 59, 0.3);
        }
        
        .player-row:hover {
            background: rgba(59, 130, 246, 0.1);
        }
        
        .player-row.dnp {
            opacity: 0.5;
            background: rgba(100, 116, 139, 0.1);
        }
        
        .table-input {
            width: 100%;
            border: none;
            background: transparent;
            color: #e2e8f0;
            text-align: center;
            padding: 4px;
            font-family: 'Montserrat', sans-serif;
            outline: none;
        }
        
        .table-input:focus {
            background: rgba(59, 130, 246, 0.1);
            border-radius: 4px;
        }
        
        .table-select {
            border: none;
            background: transparent;
            color: #e2e8f0;
            font-family: 'Montserrat', sans-serif;
            outline: none;
        }
        
        .dnp-toggle {
            padding: 4px 8px;
            border: none;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dnp-toggle.playing {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
        }
        
        .dnp-toggle.dnp {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
        }
        
        .team-totals {
            background: linear-gradient(135deg, #1e3a8a, #1d4ed8) !important;
            color: white;
            font-weight: 700;
        }
        
        .minutes-col {
            background: rgba(251, 191, 36, 0.1);
            border-left: 2px solid #fbbf24;
        }
        
        .minutes-input {
            background: rgba(251, 191, 36, 0.1);
            border-radius: 4px;
        }
        
        .post-game-section {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .post-game-title {
            color: #fbbf24;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Game Cards */
        .game-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(59, 130, 246, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        
        .game-card:hover {
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.1);
            transform: translateY(-2px);
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .game-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #3b82f6;
            margin-bottom: 0.5rem;
        }
        
        .game-info {
            color: #e2e8f0;
            font-size: 0.9rem;
        }
        
        .game-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .starter-badge {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        
        .starter-toggle {
            padding: 4px 8px;
            border: none;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
        }
        
        .starter-toggle.starter {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        
        .win-loss-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.8rem;
            margin-left: 1rem;
        }
        
        .win-badge {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
        }
        
        .loss-badge {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
            border-top: 1px solid rgba(59, 130, 246, 0.1);
        }
        
        /* Hidden by default */
        .view {
            display: none;
        }
        
        .view.active {
            display: block;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-buttons {
                gap: 4px;
            }
            
            .nav-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <span>Blue Eagles Stats</span>
                </div>
                <div class="nav-buttons">
                    <button class="nav-btn active" onclick="showView('statsheet')" id="btn-statsheet">
                        Stat Sheet
                    </button>
                    <button class="nav-btn" onclick="showView('averages')" id="btn-averages">
                        Player Averages
                    </button>
                    <button class="nav-btn" onclick="showView('tournaments')" id="btn-tournaments">
                        Tournament Stats
                    </button>
                    <button class="nav-btn" onclick="showView('yearly')" id="btn-yearly">
                        Yearly Totals
                    </button>
                    <button class="nav-btn" onclick="showView('games')" id="btn-games">
                        Saved Games
                    </button>
                    <button class="nav-btn" onclick="showView('manage')" id="btn-manage">
                        Manage
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Stat Sheet View -->
    <div id="statsheet-view" class="view active">
        <div class="container">
            <!-- Hero Section -->
            <div class="hero">
                <div class="hero-content">
                    <div class="eagle-icon">ü¶Ö</div>
                    <div>
                        <h1>ATENEO DE MANILA UNIVERSITY</h1>
                        <p>Blue Eagles Basketball</p>
                        <div class="motto">"Lux in Domino" - Light in the Lord</div>
                    </div>
                    <div class="eagle-icon">ü¶Ö</div>
                </div>
            </div>

            <!-- Game Information Card -->
            <div class="card">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <input type="date" id="gameDate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">vs Opposition</label>
                        <input type="text" id="opposition" placeholder="Opponent team" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tournament</label>
                        <select id="tournament" class="form-select">
                            <option value="">Select Tournament</option>
                            <option value="Union Sports League">Union Sports League</option>
                            <option value="RP Basketball League">RP Basketball League</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Game Type</label>
                        <select id="gameType" class="form-select">
                            <option value="">Select Game Type</option>
                            <option value="Exhibition/Tuneup">Exhibition/Tuneup</option>
                            <option value="Regular">Regular</option>
                            <option value="Playoffs - Quarterfinals">Playoffs - Quarterfinals</option>
                            <option value="Playoffs - Semis">Playoffs - Semis</option>
                            <option value="Playoffs - Finals">Playoffs - Finals</option>
                            <option value="Playoffs - Battle for 3rd">Playoffs - Battle for 3rd</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Venue</label>
                        <input type="text" id="venue" placeholder="Game venue" class="form-input">
                    </div>
                </div>
            </div>

            <!-- Final Score Section -->
            <div class="post-game-section" id="final-score-section">
                <div class="post-game-title">
                    üèÄ Final Score (Add After Game)
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; max-width: 400px; margin: 0 auto;">
                    <div class="form-group">
                        <label class="form-label">Blue Eagles Score</label>
                        <input type="number" id="teamScore" placeholder="Our score" class="form-input" min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Opponent Score</label>
                        <input type="number" id="opponentScore" placeholder="Their score" class="form-input" min="0">
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="loadRoster()">
                    Load Full Roster
                </button>
                <button class="btn btn-secondary" onclick="addPlayerToGame()">
                    Add Player to Game
                </button>
                <button class="btn btn-secondary" onclick="setStarters()">
                    Set Starters
                </button>
                <button class="btn btn-secondary" onclick="copyToClipboard()">
                    Copy Stats
                </button>
                <button class="btn btn-success" onclick="saveGame()">
                    Save Game
                </button>
                <button class="btn btn-warning" onclick="clearForm()">
                    New Game
                </button>
            </div></div>

            <!-- Stats Table -->
            <div class="table-container">
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width: 180px;">Player</th>
                            <th rowspan="2">#</th>
                            <th rowspan="2">Pos</th>
                            <th rowspan="2">Role</th>
                            <th rowspan="2">Status</th>
                            <th colspan="2">2-Point FG</th>
                            <th colspan="2">3-Point FG</th>
                            <th colspan="2">Free Throw</th>
                            <th colspan="2">Rebounds</th>
                            <th rowspan="2">Ast</th>
                            <th rowspan="2">Stl</th>
                            <th rowspan="2">Blk</th>
                            <th rowspan="2">TO</th>
                            <th rowspan="2">Fls</th>
                            <th rowspan="2">FB Pts</th>
                            <th rowspan="2" class="minutes-col">Min</th>
                            <th rowspan="2">Total Pts</th>
                            <th rowspan="2">Action</th>
                        </tr>
                        <tr>
                            <th>Att</th>
                            <th>Made</th>
                            <th>Att</th>
                            <th>Made</th>
                            <th>Att</th>
                            <th>Made</th>
                            <th>Off</th>
                            <th>Def</th>
                        </tr>
                    </thead>
                    <tbody id="playersTableBody">
                        <!-- Players will be loaded here -->
                    </tbody>
                    <tfoot>
                        <tr class="team-totals">
                            <td colspan="5"><strong>TEAM TOTALS:</strong></td>
                            <td id="total-fg2Att">0</td>
                            <td id="total-fg2Made">0</td>
                            <td id="total-fg3Att">0</td>
                            <td id="total-fg3Made">0</td>
                            <td id="total-ftAtt">0</td>
                            <td id="total-ftMade">0</td>
                            <td id="total-offReb">0</td>
                            <td id="total-defReb">0</td>
                            <td id="total-assists">0</td>
                            <td id="total-steals">0</td>
                            <td id="total-blocks">0</td>
                            <td id="total-turnovers">0</td>
                            <td id="total-fouls">0</td>
                            <td id="total-fastbreakPoints">0</td>
                            <td id="total-minutesPlayed" class="minutes-col">0</td>
                            <td id="total-totalPoints">0</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <div class="footer">
                <div style="color: #e2e8f0; font-size: 0.9rem;">¬© 2025 AWBT. All rights reserved.</div>
            </div>
        </div>
    </div>

    <!-- Player Averages View -->
    <div id="averages-view" class="view">
        <div class="container">
            <div class="hero">
                <h1>PLAYER AVERAGES</h1>
                <p>Season Statistics Overview</p>
            </div>
            <div id="averages-content" class="card">
                <p style="text-align: center; color: #e2e8f0;">No saved games yet. Start tracking games to see player averages!</p>
            </div>
        </div>
    </div>

    <!-- Tournament Stats View -->
    <div id="tournaments-view" class="view">
        <div class="container">
            <div class="hero">
                <h1>TOURNAMENT STATISTICS</h1>
                <p>Performance by Tournament</p>
            </div>
            <div id="tournaments-content" class="card">
                <p style="text-align: center; color: #e2e8f0;">No tournament games yet. Start tracking games to see tournament stats!</p>
            </div>
        </div>
    </div>

    <!-- Yearly Totals View -->
    <div id="yearly-view" class="view">
        <div class="container">
            <div class="hero">
                <h1>YEARLY TOTALS</h1>
                <p>Season Overview & Records</p>
            </div>
            <div id="yearly-content" class="card">
                <p style="text-align: center; color: #e2e8f0;">No games recorded yet. Start tracking to see yearly statistics!</p>
            </div>
        </div>
    </div>

    <!-- Saved Games View -->
    <div id="games-view" class="view">
        <div class="container">
            <div class="hero">
                <h1>SAVED GAMES</h1>
                <p>Game History & Archives</p>
            </div>
            <div class="card">
                <div class="form-grid" style="grid-template-columns: 1fr 1fr; max-width: 600px; margin: 0 auto;">
                    <div class="form-group">
                        <label class="form-label">Filter by Tournament</label>
                        <select id="games-tournament-filter" onchange="updateGamesView()" class="form-select">
                            <option value="">All Tournaments</option>
                            <option value="Union Sports League">Union Sports League</option>
                            <option value="RP Basketball League">RP Basketball League</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Filter by Game Type</label>
                        <select id="games-type-filter" onchange="updateGamesView()" class="form-select">
                            <option value="">All Game Types</option>
                            <option value="Exhibition/Tuneup">Exhibition/Tuneup</option>
                            <option value="Regular">Regular</option>
                            <option value="Playoffs - Quarterfinals">Playoffs - Quarterfinals</option>
                            <option value="Playoffs - Semis">Playoffs - Semis</option>
                            <option value="Playoffs - Finals">Playoffs - Finals</option>
                            <option value="Playoffs - Battle for 3rd">Playoffs - Battle for 3rd</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="games-content">
                <p style="text-align: center; color: #e2e8f0; padding: 2rem;">No saved games yet. Start tracking games to build your archive!</p>
            </div>
        </div>
    </div>

    <!-- Manage View -->
    <div id="manage-view" class="view">
        <div class="container">
            <div class="hero">
                <h1>MANAGE SYSTEM</h1>
                <p>Tournaments & Roster Management</p>
            </div>
            
            <div class="card">
                <h3 style="color: #3b82f6; margin-bottom: 1rem; font-weight: 700;">Team Roster</h3>
                <div class="action-buttons" style="margin: 1rem 0;">
                    <button class="btn btn-primary" onclick="addPlayerToRoster()">
                        Add Player to Roster
                    </button>
                    <button class="btn btn-secondary" onclick="exportRoster()">
                        Export Roster
                    </button>
                </div>
                <div id="roster-list" class="table-container">
                    <!-- Roster will be displayed here -->
                </div>
            </div>
            
            <div class="card">
                <h3 style="color: #3b82f6; margin-bottom: 1rem; font-weight: 700;">Tournament Management</h3>
                <div class="form-grid" style="grid-template-columns: 1fr auto; max-width: 600px;">
                    <div class="form-group">
                        <label class="form-label">New Tournament Name</label>
                        <input type="text" id="new-tournament-name" placeholder="Tournament Name" class="form-input">
                    </div>
                    <div class="form-group" style="align-self: end;">
                        <button class="btn btn-primary" onclick="addTournament()">
                            Add Tournament
                        </button>
                    </div>
                </div>
                
                <div id="tournaments-list" style="margin-top: 2rem;">
                    <!-- Tournament list will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentRoster = [
            {id: 1, firstName: "Kate", lastName: "Cancio", number: "5", position: "", isStarter: false},
            {id: 2, firstName: "Gracie", lastName: "Batongbakal", number: "6", position: "", isStarter: false},
            {id: 3, firstName: "Monique", lastName: "Fetalvero", number: "7", position: "", isStarter: false},
            {id: 4, firstName: "Rish", lastName: "Olivenza", number: "8", position: "", isStarter: false},
            {id: 5, firstName: "Erica", lastName: "de Luna", number: "14", position: "", isStarter: false},
            {id: 6, firstName: "Sandra", lastName: "Villacruz", number: "16", position: "", isStarter: false},
            {id: 7, firstName: "Lauren", lastName: "Lopez", number: "19", position: "", isStarter: false},
            {id: 8, firstName: "Hannah", lastName: "Lopez", number: "20", position: "", isStarter: false},
            {id: 9, firstName: "Phia", lastName: "Cruza", number: "21", position: "", isStarter: false},
            {id: 10, firstName: "Gwen", lastName: "Chan", number: "22", position: "", isStarter: false},
            {id: 11, firstName: "Sarah", lastName: "Makanjoula", number: "23", position: "", isStarter: false},
            {id: 12, firstName: "Kai", lastName: "Oani", number: "24", position: "", isStarter: false},
            {id: 13, firstName: "Kacey", lastName: "Dela Rosa", number: "28", position: "", isStarter: false},
            {id: 14, firstName: "Candice", lastName: "Udal", number: "34", position: "", isStarter: false},
            {id: 15, firstName: "Camille", lastName: "Malagar", number: "45", position: "", isStarter: false}
        ];

        let savedGames = JSON.parse(localStorage.getItem('basketballGames')) || [];
        let gameIdCounter = parseInt(localStorage.getItem('gameIdCounter')) || 1;
        let currentGamePlayers = [];

        // Navigation functions
        function showView(viewName) {
            // Hide all views
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected view
            document.getElementById(viewName + '-view').classList.add('active');
            document.getElementById('btn-' + viewName).classList.add('active');
            
            // Update content for specific views
            if (viewName === 'games') {
                updateGamesView();
            } else if (viewName === 'averages') {
                updateAveragesView();
            } else if (viewName === 'tournaments') {
                updateTournamentsView();
            } else if (viewName === 'yearly') {
                updateYearlyView();
            } else if (viewName === 'manage') {
                updateManageView();
            }
        }

        // Load roster into the game
        function loadRoster() {
            currentGamePlayers = [];
            const tbody = document.getElementById('playersTableBody');
            tbody.innerHTML = '';
            
            // Sort roster so starters appear first
            const sortedRoster = [...currentRoster].sort((a, b) => {
                if (a.isStarter && !b.isStarter) return -1;
                if (!a.isStarter && b.isStarter) return 1;
                return 0;
            });
            
            sortedRoster.forEach(player => {
                const gamePlayer = {
                    ...player,
                    fg2Att: 0, fg2Made: 0,
                    fg3Att: 0, fg3Made: 0,
                    ftAtt: 0, ftMade: 0,
                    offReb: 0, defReb: 0,
                    assists: 0, steals: 0, blocks: 0,
                    turnovers: 0, fouls: 0,
                    fastbreakPoints: 0, minutesPlayed: 0,
                    status: 'playing'
                };
                currentGamePlayers.push(gamePlayer);
                addPlayerRow(gamePlayer);
            });
            
            updateTeamTotals();
        }

        // Add a single player to the game
        function addPlayerToGame() {
            const firstName = prompt("Player's first name:");
            const lastName = prompt("Player's last name:");
            const number = prompt("Jersey number:");
            const position = prompt("Position (PG/SG/SF/PF/C):");
            
            if (firstName && lastName && number) {
                const newPlayer = {
                    id: Date.now(),
                    firstName: firstName.trim(),
                    lastName: lastName.trim(),
                    number: number.trim(),
                    position: position.trim() || '',
                    fg2Att: 0, fg2Made: 0,
                    fg3Att: 0, fg3Made: 0,
                    ftAtt: 0, ftMade: 0,
                    offReb: 0, defReb: 0,
                    assists: 0, steals: 0, blocks: 0,
                    turnovers: 0, fouls: 0,
                    fastbreakPoints: 0, minutesPlayed: 0,
                    status: 'playing'
                };
                
                currentGamePlayers.push(newPlayer);
                addPlayerRow(newPlayer);
                updateTeamTotals();
            }
        }

        // Add player row to the table
        function addPlayerRow(player) {
            const tbody = document.getElementById('playersTableBody');
            const row = document.createElement('tr');
            row.className = 'player-row';
            row.id = `player-${player.id}`;
            
            const totalPoints = (player.fg2Made * 2) + (player.fg3Made * 3) + player.ftMade + player.fastbreakPoints;
            const starterDisplay = player.isStarter ? '*' : '';
            
            row.innerHTML = `
                <td>${player.firstName} ${player.lastName}${starterDisplay ? '<span class="starter-badge">STARTER</span>' : ''}</td>
                <td>${player.number}</td>
                <td>
                    <select class="table-select" onchange="updatePlayerData(${player.id}, 'position', this.value)">
                        <option value="">-</option>
                        <option value="PG" ${player.position === 'PG' ? 'selected' : ''}>PG</option>
                        <option value="SG" ${player.position === 'SG' ? 'selected' : ''}>SG</option>
                        <option value="SF" ${player.position === 'SF' ? 'selected' : ''}>SF</option>
                        <option value="PF" ${player.position === 'PF' ? 'selected' : ''}>PF</option>
                        <option value="C" ${player.position === 'C' ? 'selected' : ''}>C</option>
                    </select>
                </td>
                <td>
                    <button class="starter-toggle ${player.isStarter ? 'starter' : 'bench'}" onclick="toggleStarter(${player.id})">
                        ${player.isStarter ? 'STARTER' : 'BENCH'}
                    </button>
                </td>
                <td>
                    <button class="dnp-toggle ${player.status}" onclick="toggleDNP(${player.id})">
                        ${player.status === 'playing' ? 'PLAYING' : 'DNP'}
                    </button>
                </td>
                <td><input type="number" class="table-input" value="${player.fg2Att}" min="0" onchange="updatePlayerData(${player.id}, 'fg2Att', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.fg2Made}" min="0" onchange="updatePlayerData(${player.id}, 'fg2Made', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.fg3Att}" min="0" onchange="updatePlayerData(${player.id}, 'fg3Att', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.fg3Made}" min="0" onchange="updatePlayerData(${player.id}, 'fg3Made', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.ftAtt}" min="0" onchange="updatePlayerData(${player.id}, 'ftAtt', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.ftMade}" min="0" onchange="updatePlayerData(${player.id}, 'ftMade', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.offReb}" min="0" onchange="updatePlayerData(${player.id}, 'offReb', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.defReb}" min="0" onchange="updatePlayerData(${player.id}, 'defReb', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.assists}" min="0" onchange="updatePlayerData(${player.id}, 'assists', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.steals}" min="0" onchange="updatePlayerData(${player.id}, 'steals', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.blocks}" min="0" onchange="updatePlayerData(${player.id}, 'blocks', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.turnovers}" min="0" onchange="updatePlayerData(${player.id}, 'turnovers', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.fouls}" min="0" onchange="updatePlayerData(${player.id}, 'fouls', this.value)"></td>
                <td><input type="number" class="table-input" value="${player.fastbreakPoints}" min="0" onchange="updatePlayerData(${player.id}, 'fastbreakPoints', this.value)"></td>
                <td class="minutes-col"><input type="number" class="table-input minutes-input" value="${player.minutesPlayed}" min="0" onchange="updatePlayerData(${player.id}, 'minutesPlayed', this.value)"></td>
                <td>${totalPoints}</td>
                <td><button class="btn btn-danger btn-small" onclick="removePlayer(${player.id})">Remove</button></td>
            `;
            
            tbody.appendChild(row);
        }

        // Update player data
        function updatePlayerData(playerId, field, value) {
            const player = currentGamePlayers.find(p => p.id === playerId);
            if (player) {
                if (field === 'position') {
                    player[field] = value;
                } else {
                    player[field] = parseInt(value) || 0;
                    
                    // Validate made shots don't exceed attempts
                    if (field === 'fg2Made' && player.fg2Made > player.fg2Att) {
                        player.fg2Att = player.fg2Made;
                        document.querySelector(`#player-${playerId} input[onchange*="fg2Att"]`).value = player.fg2Att;
                    }
                    if (field === 'fg3Made' && player.fg3Made > player.fg3Att) {
                        player.fg3Att = player.fg3Made;
                        document.querySelector(`#player-${playerId} input[onchange*="fg3Att"]`).value = player.fg3Att;
                    }
                    if (field === 'ftMade' && player.ftMade > player.ftAtt) {
                        player.ftAtt = player.ftMade;
                        document.querySelector(`#player-${playerId} input[onchange*="ftAtt"]`).value = player.ftAtt;
                    }
                }
                
                updatePlayerTotalPoints(playerId);
                updateTeamTotals();
            }
        }

        // Toggle starter status
        function toggleStarter(playerId) {
            const player = currentGamePlayers.find(p => p.id === playerId);
            if (player) {
                player.isStarter = !player.isStarter;
                const button = document.querySelector(`#player-${playerId} .starter-toggle`);
                const nameCell = document.querySelector(`#player-${playerId} td:first-child`);
                
                if (player.isStarter) {
                    button.classList.remove('bench');
                    button.classList.add('starter');
                    button.textContent = 'STARTER';
                    nameCell.innerHTML = `${player.firstName} ${player.lastName}<span class="starter-badge">STARTER</span>`;
                } else {
                    button.classList.remove('starter');
                    button.classList.add('bench');
                    button.textContent = 'BENCH';
                    nameCell.innerHTML = `${player.firstName} ${player.lastName}`;
                }
                
                // Re-sort players so starters appear first
                sortPlayersByStarter();
            }
        }

        // Sort players so starters appear first
        function sortPlayersByStarter() {
            const tbody = document.getElementById('playersTableBody');
            const rows = Array.from(tbody.querySelectorAll('.player-row'));
            
            rows.sort((a, b) => {
                const aId = parseInt(a.id.split('-')[1]);
                const bId = parseInt(b.id.split('-')[1]);
                const aPlayer = currentGamePlayers.find(p => p.id === aId);
                const bPlayer = currentGamePlayers.find(p => p.id === bId);
                
                if (aPlayer.isStarter && !bPlayer.isStarter) return -1;
                if (!aPlayer.isStarter && bPlayer.isStarter) return 1;
                return 0;
            });
            
            tbody.innerHTML = '';
            rows.forEach(row => tbody.appendChild(row));
        }

        // Set starters quickly
        function setStarters() {
            const starterCount = currentGamePlayers.filter(p => p.isStarter).length;
            const message = starterCount > 0 
                ? `Currently ${starterCount} starters selected. Click the STARTER/BENCH buttons next to player names to change starting lineup.`
                : 'Click the STARTER/BENCH buttons next to player names to set your starting 5.';
            
            alert(message);
        }

        // Update player's total points
        function updatePlayerTotalPoints(playerId) {
            const player = currentGamePlayers.find(p => p.id === playerId);
            if (player) {
                const totalPoints = (player.fg2Made * 2) + (player.fg3Made * 3) + player.ftMade + player.fastbreakPoints;
                document.querySelector(`#player-${playerId} td:last-child`).previousElementSibling.textContent = totalPoints;
            }
        }

        // Toggle DNP status
        function toggleDNP(playerId) {
            const player = currentGamePlayers.find(p => p.id === playerId);
            if (player) {
                player.status = player.status === 'playing' ? 'dnp' : 'playing';
                const row = document.getElementById(`player-${playerId}`);
                const button = row.querySelector('.dnp-toggle');
                
                if (player.status === 'dnp') {
                    row.classList.add('dnp');
                    button.classList.remove('playing');
                    button.classList.add('dnp');
                    button.textContent = 'DNP';
                } else {
                    row.classList.remove('dnp');
                    button.classList.remove('dnp');
                    button.classList.add('playing');
                    button.textContent = 'PLAYING';
                }
            }
        }

        // Remove player from game
        function removePlayer(playerId) {
            if (confirm('Remove this player from the game?')) {
                currentGamePlayers = currentGamePlayers.filter(p => p.id !== playerId);
                document.getElementById(`player-${playerId}`).remove();
                updateTeamTotals();
            }
        }

        // Update team totals
        function updateTeamTotals() {
            const totals = {
                fg2Att: 0, fg2Made: 0, fg3Att: 0, fg3Made: 0,
                ftAtt: 0, ftMade: 0, offReb: 0, defReb: 0,
                assists: 0, steals: 0, blocks: 0, turnovers: 0,
                fouls: 0, fastbreakPoints: 0, minutesPlayed: 0, totalPoints: 0
            };
            
            currentGamePlayers.forEach(player => {
                if (player.status === 'playing') {
                    Object.keys(totals).forEach(key => {
                        if (key !== 'totalPoints') {
                            totals[key] += player[key] || 0;
                        }
                    });
                }
            });
            
            totals.totalPoints = (totals.fg2Made * 2) + (totals.fg3Made * 3) + totals.ftMade + totals.fastbreakPoints;
            
            // Update footer row
            Object.keys(totals).forEach(key => {
                const element = document.getElementById(`total-${key}`);
                if (element) {
                    element.textContent = totals[key];
                }
            });
        }

        // Save game
        function saveGame() {
            const gameData = {
                id: gameIdCounter++,
                date: document.getElementById('gameDate').value,
                opposition: document.getElementById('opposition').value,
                tournament: document.getElementById('tournament').value,
                gameType: document.getElementById('gameType').value,
                venue: document.getElementById('venue').value,
                teamScore: parseInt(document.getElementById('teamScore').value) || null,
                opponentScore: parseInt(document.getElementById('opponentScore').value) || null,
                players: [...currentGamePlayers],
                timestamp: new Date().toISOString()
            };
            
            // Calculate win/loss
            if (gameData.teamScore !== null && gameData.opponentScore !== null) {
                gameData.result = gameData.teamScore > gameData.opponentScore ? 'W' : 'L';
            }
            
            if (!gameData.date || !gameData.opposition) {
                alert('Please fill in the date and opposition before saving.');
                return;
            }
            
            savedGames.push(gameData);
            localStorage.setItem('basketballGames', JSON.stringify(savedGames));
            localStorage.setItem('gameIdCounter', gameIdCounter.toString());
            
            alert('Game saved successfully!');
        }

        // Clear form for new game
        function clearForm() {
            if (confirm('Clear all data and start a new game?')) {
                document.getElementById('gameDate').value = '';
                document.getElementById('opposition').value = '';
                document.getElementById('tournament').value = '';
                document.getElementById('gameType').value = '';
                document.getElementById('venue').value = '';
                document.getElementById('teamScore').value = '';
                document.getElementById('opponentScore').value = '';
                
                currentGamePlayers = [];
                document.getElementById('playersTableBody').innerHTML = '';
                updateTeamTotals();
            }
        }

        // Copy stats to clipboard
        function copyToClipboard() {
            let statsText = `ATENEO BLUE EAGLES BASKETBALL STATISTICS\n`;
            statsText += `===========================================\n`;
            statsText += `Date: ${document.getElementById('gameDate').value}\n`;
            statsText += `vs ${document.getElementById('opposition').value}\n`;
            statsText += `Tournament: ${document.getElementById('tournament').value}\n`;
            statsText += `Game Type: ${document.getElementById('gameType').value}\n`;
            statsText += `Venue: ${document.getElementById('venue').value}\n\n`;
            
            const teamScore = document.getElementById('teamScore').value;
            const opponentScore = document.getElementById('opponentScore').value;
            if (teamScore && opponentScore) {
                statsText += `FINAL SCORE: Blue Eagles ${teamScore} - ${opponentScore} ${document.getElementById('opposition').value}\n\n`;
            }
            
            statsText += `PLAYER STATISTICS:\n`;
            statsText += `Name\t#\tPos\tStatus\t2FGA\t2FGM\t3FGA\t3FGM\tFTA\tFTM\tORB\tDRB\tAST\tSTL\tBLK\tTO\tFL\tFB\tMIN\tPTS\n`;
            
            currentGamePlayers.forEach(player => {
                const totalPoints = (player.fg2Made * 2) + (player.fg3Made * 3) + player.ftMade + player.fastbreakPoints;
                const starterMark = player.isStarter ? '*' : '';
                statsText += `${player.firstName} ${player.lastName}${starterMark}\t${player.number}\t${player.position}\t${player.status}\t${player.fg2Att}\t${player.fg2Made}\t${player.fg3Att}\t${player.fg3Made}\t${player.ftAtt}\t${player.ftMade}\t${player.offReb}\t${player.defReb}\t${player.assists}\t${player.steals}\t${player.blocks}\t${player.turnovers}\t${player.fouls}\t${player.fastbreakPoints}\t${player.minutesPlayed}\t${totalPoints}\n`;
            });
            
            navigator.clipboard.writeText(statsText).then(() => {
                alert('Statistics copied to clipboard!');
            });
        }

        // Update games view
        function updateGamesView() {
            const container = document.getElementById('games-content');
            const tournamentFilter = document.getElementById('games-tournament-filter').value;
            const typeFilter = document.getElementById('games-type-filter').value;
            
            let filteredGames = savedGames;
            
            if (tournamentFilter) {
                filteredGames = filteredGames.filter(game => game.tournament === tournamentFilter);
            }
            
            if (typeFilter) {
                filteredGames = filteredGames.filter(game => game.gameType === typeFilter);
            }
            
            if (filteredGames.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #e2e8f0; padding: 2rem;">No games found matching the selected filters.</p>';
                return;
            }
            
            container.innerHTML = filteredGames.map(game => {
                const gameDate = new Date(game.date).toLocaleDateString();
                let resultBadge = '';
                let scoreDisplay = '';
                
                if (game.teamScore !== null && game.opponentScore !== null) {
                    resultBadge = `<span class="win-loss-badge ${game.result === 'W' ? 'win-badge' : 'loss-badge'}">${game.result}</span>`;
                    scoreDisplay = `<div style="margin-top: 0.5rem; font-weight: 600;">Final Score: ${game.teamScore} - ${game.opponentScore}</div>`;
                }
                
                return `
                    <div class="game-card">
                        <div class="game-header">
                            <div>
                                <div class="game-title">vs ${game.opposition}${resultBadge}</div>
                                <div class="game-info">
                                    ${gameDate} ‚Ä¢ ${game.tournament} ‚Ä¢ ${game.gameType}<br>
                                    Venue: ${game.venue}
                                    ${scoreDisplay}
                                </div>
                            </div>
                            <div class="game-actions">
                                <button class="btn btn-secondary btn-small" onclick="viewGameDetails(${game.id})">View Details</button>
                                <button class="btn btn-danger btn-small" onclick="deleteGame(${game.id})">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update averages view
        function updateAveragesView() {
            const container = document.getElementById('averages-content');
            
            if (savedGames.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #e2e8f0;">No saved games yet. Start tracking games to see player averages!</p>';
                return;
            }
            
            const playerStats = {};
            
            savedGames.forEach(game => {
                game.players.forEach(player => {
                    if (player.status === 'playing') {
                        const key = `${player.firstName} ${player.lastName}`;
                        if (!playerStats[key]) {
                            playerStats[key] = {
                                gamesPlayed: 0,
                                totalPoints: 0, totalAssists: 0, totalRebounds: 0,
                                totalSteals: 0, totalBlocks: 0, totalTurnovers: 0,
                                totalFouls: 0, totalMinutes: 0,
                                fg2Made: 0, fg2Att: 0, fg3Made: 0, fg3Att: 0,
                                ftMade: 0, ftAtt: 0
                            };
                        }
                        
                        playerStats[key].gamesPlayed++;
                        playerStats[key].totalPoints += (player.fg2Made * 2) + (player.fg3Made * 3) + player.ftMade + player.fastbreakPoints;
                        playerStats[key].totalAssists += player.assists;
                        playerStats[key].totalRebounds += player.offReb + player.defReb;
                        playerStats[key].totalSteals += player.steals;
                        playerStats[key].totalBlocks += player.blocks;
                        playerStats[key].totalTurnovers += player.turnovers;
                        playerStats[key].totalFouls += player.fouls;
                        playerStats[key].totalMinutes += player.minutesPlayed;
                        playerStats[key].fg2Made += player.fg2Made;
                        playerStats[key].fg2Att += player.fg2Att;
                        playerStats[key].fg3Made += player.fg3Made;
                        playerStats[key].fg3Att += player.fg3Att;
                        playerStats[key].ftMade += player.ftMade;
                        playerStats[key].ftAtt += player.ftAtt;
                    }
                });
            });
            
            const playersArray = Object.entries(playerStats).map(([name, stats]) => ({
                name,
                gamesPlayed: stats.gamesPlayed,
                ppg: (stats.totalPoints / stats.gamesPlayed).toFixed(1),
                apg: (stats.totalAssists / stats.gamesPlayed).toFixed(1),
                rpg: (stats.totalRebounds / stats.gamesPlayed).toFixed(1),
                spg: (stats.totalSteals / stats.gamesPlayed).toFixed(1),
                bpg: (stats.totalBlocks / stats.gamesPlayed).toFixed(1),
                topg: (stats.totalTurnovers / stats.gamesPlayed).toFixed(1),
                fpg: (stats.totalFouls / stats.gamesPlayed).toFixed(1),
                mpg: (stats.totalMinutes / stats.gamesPlayed).toFixed(1),
                fg2Pct: stats.fg2Att > 0 ? ((stats.fg2Made / stats.fg2Att) * 100).toFixed(1) : '0.0',
                fg3Pct: stats.fg3Att > 0 ? ((stats.fg3Made / stats.fg3Att) * 100).toFixed(1) : '0.0',
                ftPct: stats.ftAtt > 0 ? ((stats.ftMade / stats.ftAtt) * 100).toFixed(1) : '0.0'
            }));
            
            playersArray.sort((a, b) => parseFloat(b.ppg) - parseFloat(a.ppg));
            
            let html = `
                <div class="table-container">
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Player</th>
                                <th>GP</th>
                                <th>PPG</th>
                                <th>APG</th>
                                <th>RPG</th>
                                <th>SPG</th>
                                <th>BPG</th>
                                <th>TOPG</th>
                                <th>FPG</th>
                                <th>MPG</th>
                                <th>2FG%</th>
                                <th>3FG%</th>
                                <th>FT%</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            playersArray.forEach(player => {
                html += `
                    <tr class="player-row">
                        <td style="text-align: left; font-weight: 600;">${player.name}</td>
                        <td>${player.gamesPlayed}</td>
                        <td>${player.ppg}</td>
                        <td>${player.apg}</td>
                        <td>${player.rpg}</td>
                        <td>${player.spg}</td>
                        <td>${player.bpg}</td>
                        <td>${player.topg}</td>
                        <td>${player.fpg}</td>
                        <td>${player.mpg}</td>
                        <td>${player.fg2Pct}%</td>
                        <td>${player.fg3Pct}%</td>
                        <td>${player.ftPct}%</td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            container.innerHTML = html;
        }

        // Update tournaments view
        function updateTournamentsView() {
            const container = document.getElementById('tournaments-content');
            
            if (savedGames.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #e2e8f0;">No tournament games yet. Start tracking games to see tournament stats!</p>';
                return;
            }
            
            const tournamentStats = {};
            
            savedGames.forEach(game => {
                if (game.tournament) {
                    if (!tournamentStats[game.tournament]) {
                        tournamentStats[game.tournament] = {
                            games: 0, wins: 0, losses: 0,
                            totalPoints: 0, totalOpponentPoints: 0,
                            players: {}
                        };
                    }
                    
                    const tStats = tournamentStats[game.tournament];
                    tStats.games++;
                    
                    if (game.result === 'W') tStats.wins++;
                    if (game.result === 'L') tStats.losses++;
                    
                    if (game.teamScore !== null) tStats.totalPoints += game.teamScore;
                    if (game.opponentScore !== null) tStats.totalOpponentPoints += game.opponentScore;
                    
                    game.players.forEach(player => {
                        if (player.status === 'playing') {
                            const key = `${player.firstName} ${player.lastName}`;
                            if (!tStats.players[key]) {
                                tStats.players[key] = { games: 0, points: 0, assists: 0, rebounds: 0 };
                            }
                            
                            tStats.players[key].games++;
                            tStats.players[key].points += (player.fg2Made * 2) + (player.fg3Made * 3) + player.ftMade + player.fastbreakPoints;
                            tStats.players[key].assists += player.assists;
                            tStats.players[key].rebounds += player.offReb + player.defReb;
                        }
                    });
                }
            });
            
            let html = '';
            
            Object.entries(tournamentStats).forEach(([tournament, stats]) => {
                const avgPoints = stats.games > 0 ? (stats.totalPoints / stats.games).toFixed(1) : '0.0';
                const avgOpponentPoints = stats.games > 0 ? (stats.totalOpponentPoints / stats.games).toFixed(1) : '0.0';
                
                html += `
                    <div class="card">
                        <h3 style="color: #3b82f6; margin-bottom: 1rem; font-weight: 700;">${tournament}</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                            <div style="text-align: center; background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="font-size: 2rem; font-weight: 700; color: #3b82f6;">${stats.games}</div>
                                <div style="color: #e2e8f0;">Games Played</div>
                            </div>
                            <div style="text-align: center; background: rgba(5, 150, 105, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="font-size: 2rem; font-weight: 700; color: #059669;">${stats.wins}</div>
                                <div style="color: #e2e8f0;">Wins</div>
                            </div>
                            <div style="text-align: center; background: rgba(220, 38, 38, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="font-size: 2rem; font-weight: 700; color: #dc2626;">${stats.losses}</div>
                                <div style="color: #e2e8f0;">Losses</div>
                            </div>
                            <div style="text-align: center; background: rgba(251, 191, 36, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="font-size: 2rem; font-weight: 700; color: #fbbf24;">${avgPoints}</div>
                                <div style="color: #e2e8f0;">Avg Points</div>
                            </div>
                        </div>
                        
                        <h4 style="color: #3b82f6; margin-bottom: 0.5rem;">Top Performers:</h4>
                        <div class="table-container">
                            <table class="stats-table">
                                <thead>
                                    <tr>
                                        <th>Player</th>
                                        <th>Games</th>
                                        <th>PPG</th>
                                        <th>APG</th>
                                        <th>RPG</th>
                                    </tr>
                                </thead>
                                <tbody>
                `;
                
                const topPlayers = Object.entries(stats.players)
                    .map(([name, playerStats]) => ({
                        name,
                        games: playerStats.games,
                        ppg: (playerStats.points / playerStats.games).toFixed(1),
                        apg: (playerStats.assists / playerStats.games).toFixed(1),
                        rpg: (playerStats.rebounds / playerStats.games).toFixed(1)
                    }))
                    .sort((a, b) => parseFloat(b.ppg) - parseFloat(a.ppg))
                    .slice(0, 10);
                
                topPlayers.forEach(player => {
                    html += `
                        <tr class="player-row">
                            <td style="text-align: left; font-weight: 600;">${player.name}</td>
                            <td>${player.games}</td>
                            <td>${player.ppg}</td>
                            <td>${player.apg}</td>
                            <td>${player.rpg}</td>
                        </tr>
                    `;
                });
                
                html += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<p style="text-align: center; color: #e2e8f0;">No tournament games yet. Start tracking games to see tournament stats!</p>';
        }

        // Update yearly view
        function updateYearlyView() {
            const container = document.getElementById('yearly-content');
            
            if (savedGames.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #e2e8f0;">No games recorded yet. Start tracking to see yearly statistics!</p>';
                return;
            }
            
            const currentYear = new Date().getFullYear();
            const yearlyGames = savedGames.filter(game => {
                const gameYear = new Date(game.date).getFullYear();
                return gameYear === currentYear;
            });
            
            if (yearlyGames.length === 0) {
                container.innerHTML = `<p style="text-align: center; color: #e2e8f0;">No games recorded for ${currentYear} yet.</p>`;
                return;
            }
            
            let totalWins = 0, totalLosses = 0;
            let totalPoints = 0, totalOpponentPoints = 0;
            const playerTotals = {};
            
            yearlyGames.forEach(game => {
                if (game.result === 'W') totalWins++;
                if (game.result === 'L') totalLosses++;
                if (game.teamScore !== null) totalPoints += game.teamScore;
                if (game.opponentScore !== null) totalOpponentPoints += game.opponentScore;
                
                game.players.forEach(player => {
                    if (player.status === 'playing') {
                        const key = `${player.firstName} ${player.lastName}`;
                        if (!playerTotals[key]) {
                            playerTotals[key] = {
                                games: 0, points: 0, assists: 0, rebounds: 0,
                                steals: 0, blocks: 0, turnovers: 0, fouls: 0
                            };
                        }
                        
                        playerTotals[key].games++;
                        playerTotals[key].points += (player.fg2Made * 2) + (player.fg3Made * 3) + player.ftMade + player.fastbreakPoints;
                        playerTotals[key].assists += player.assists;
                        playerTotals[key].rebounds += player.offReb + player.defReb;
                        playerTotals[key].steals += player.steals;
                        playerTotals[key].blocks += player.blocks;
                        playerTotals[key].turnovers += player.turnovers;
                        playerTotals[key].fouls += player.fouls;
                    }
                });
            });
            
            const avgPoints = yearlyGames.length > 0 ? (totalPoints / yearlyGames.length).toFixed(1) : '0.0';
            const winPct = (totalWins + totalLosses) > 0 ? ((totalWins / (totalWins + totalLosses)) * 100).toFixed(1) : '0.0';
            
            let html = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div style="text-align: center; background: rgba(59, 130, 246, 0.1); padding: 1.5rem; border-radius: 12px;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: #3b82f6;">${yearlyGames.length}</div>
                        <div style="color: #e2e8f0; font-weight: 600;">Games Played</div>
                    </div>
                    <div style="text-align: center; background: rgba(5, 150, 105, 0.1); padding: 1.5rem; border-radius: 12px;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: #059669;">${totalWins}-${totalLosses}</div>
                        <div style="color: #e2e8f0; font-weight: 600;">Win-Loss Record</div>
                    </div>
                    <div style="text-align: center; background: rgba(251, 191, 36, 0.1); padding: 1.5rem; border-radius: 12px;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: #fbbf24;">${winPct}%</div>
                        <div style="color: #e2e8f0; font-weight: 600;">Win Percentage</div>
                    </div>
                    <div style="text-align: center; background: rgba(139, 92, 246, 0.1); padding: 1.5rem; border-radius: 12px;">
                        <div style="font-size: 2.5rem; font-weight: 700; color: #8b5cf6;">${avgPoints}</div>
                        <div style="color: #e2e8f0; font-weight: 600;">Avg Points Per Game</div>
                    </div>
                </div>
                
                <h3 style="color: #3b82f6; margin-bottom: 1rem; font-weight: 700;">${currentYear} Player Totals</h3>
                <div class="table-container">
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Player</th>
                                <th>GP</th>
                                <th>Total PTS</th>
                                <th>Total AST</th>
                                <th>Total REB</th>
                                <th>Total STL</th>
                                <th>Total BLK</th>
                                <th>Total TO</th>
                                <th>Total FL</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            const sortedPlayers = Object.entries(playerTotals)
                .sort(([,a], [,b]) => b.points - a.points);
            
            sortedPlayers.forEach(([name, stats]) => {
                html += `
                    <tr class="player-row">
                        <td style="text-align: left; font-weight: 600;">${name}</td>
                        <td>${stats.games}</td>
                        <td>${stats.points}</td>
                        <td>${stats.assists}</td>
                        <td>${stats.rebounds}</td>
                        <td>${stats.steals}</td>
                        <td>${stats.blocks}</td>
                        <td>${stats.turnovers}</td>
                        <td>${stats.fouls}</td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            container.innerHTML = html;
        }

        // Update manage view
        function updateManageView() {
            updateRosterList();
            updateTournamentsList();
        }

        // Update roster list in manage view
        function updateRosterList() {
            const container = document.getElementById('roster-list');
            
            let html = `
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Player Name</th>
                            <th>Jersey #</th>
                            <th>Position</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            currentRoster.forEach(player => {
                html += `
                    <tr class="player-row">
                        <td style="text-align: left; font-weight: 600;">${player.firstName} ${player.lastName}</td>
                        <td>
                            <input type="text" class="table-input" value="${player.number}" 
                                   onchange="updateRosterPlayerNumber(${player.id}, this.value)" 
                                   style="width: 60px; text-align: center;">
                        </td>
                        <td>
                            <select onchange="updateRosterPlayerPosition(${player.id}, this.value)" class="table-select">
                                <option value="">Select Position</option>
                                <option value="PG" ${player.position === 'PG' ? 'selected' : ''}>Point Guard (PG)</option>
                                <option value="SG" ${player.position === 'SG' ? 'selected' : ''}>Shooting Guard (SG)</option>
                                <option value="SF" ${player.position === 'SF' ? 'selected' : ''}>Small Forward (SF)</option>
                                <option value="PF" ${player.position === 'PF' ? 'selected' : ''}>Power Forward (PF)</option>
                                <option value="C" ${player.position === 'C' ? 'selected' : ''}>Center (C)</option>
                            </select>
                        </td>
                        <td>
                            <button class="btn btn-danger btn-small" onclick="removeFromRoster(${player.id})">Remove</button>
                        </td>
                    </tr>
                `;
            });
            
            html += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = html;
        }

        // Management functions
        function addPlayerToRoster() {
            const firstName = prompt("Player's first name:");
            const lastName = prompt("Player's last name:");
            const number = prompt("Jersey number:");
            
            if (firstName && lastName && number) {
                const newPlayer = {
                    id: Date.now(),
                    firstName: firstName.trim(),
                    lastName: lastName.trim(),
                    number: number.trim(),
                    position: '',
                    isStarter: false
                };
                
                currentRoster.push(newPlayer);
                localStorage.setItem('basketballRoster', JSON.stringify(currentRoster));
                updateRosterList();
            }
        }

        function removeFromRoster(playerId) {
            if (confirm('Remove this player from the roster permanently?')) {
                currentRoster = currentRoster.filter(p => p.id !== playerId);
                localStorage.setItem('basketballRoster', JSON.stringify(currentRoster));
                updateRosterList();
            }
        }

        function updateRosterPlayerPosition(playerId, position) {
            const player = currentRoster.find(p => p.id === playerId);
            if (player) {
                player.position = position;
                localStorage.setItem('basketballRoster', JSON.stringify(currentRoster));
            }
        }

        function updateRosterPlayerNumber(playerId, number) {
            const player = currentRoster.find(p => p.id === playerId);
            if (player) {
                player.number = number.trim();
                localStorage.setItem('basketballRoster', JSON.stringify(currentRoster));
            }
        }

        function exportRoster() {
            let rosterText = "ATENEO BLUE EAGLES ROSTER\n";
            rosterText += "========================\n\n";
            
            currentRoster.forEach(player => {
                rosterText += `#${player.number} - ${player.firstName} ${player.lastName}`;
                if (player.position) rosterText += ` (${player.position})`;
                rosterText += "\n";
            });
            
            navigator.clipboard.writeText(rosterText).then(() => {
                alert('Roster copied to clipboard!');
            });
        }

        function addTournament() {
            const name = document.getElementById('new-tournament-name').value.trim();
            if (name) {
                const select = document.getElementById('tournament');
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
                
                document.getElementById('new-tournament-name').value = '';
                updateTournamentsList();
            }
        }

        function updateTournamentsList() {
            const container = document.getElementById('tournaments-list');
            const select = document.getElementById('tournament');
            const tournaments = Array.from(select.options)
                .filter(option => option.value !== '')
                .map(option => option.value);
            
            if (tournaments.length === 0) {
                container.innerHTML = '<p style="color: #e2e8f0;">No custom tournaments added yet.</p>';
                return;
            }
            
            let html = '<h4 style="color: #3b82f6; margin-bottom: 0.5rem;">Current Tournaments:</h4>';
            html += '<ul style="color: #e2e8f0; margin-left: 1rem;">';
            
            tournaments.forEach(tournament => {
                html += `<li style="margin-bottom: 0.25rem;">${tournament}</li>`;
            });
            
            html += '</ul>';
            container.innerHTML = html;
        }

        // Game management functions
        function viewGameDetails(gameId) {
            const game = savedGames.find(g => g.id === gameId);
            if (game) {
                alert(`Game Details:\n\nDate: ${game.date}\nOpponent: ${game.opposition}\nTournament: ${game.tournament}\nType: ${game.gameType}\nVenue: ${game.venue}\n\nPlayers in game: ${game.players.length}`);
            }
        }

        function deleteGame(gameId) {
            if (confirm('Delete this game permanently?')) {
                savedGames = savedGames.filter(g => g.id !== gameId);
                localStorage.setItem('basketballGames', JSON.stringify(savedGames));
                updateGamesView();
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved roster if exists
            const savedRoster = localStorage.getItem('basketballRoster');
            if (savedRoster) {
                currentRoster = JSON.parse(savedRoster);
            }
            
            // Set today's date as default
            document.getElementById('gameDate').value = new Date().toISOString().split('T')[0];
            
            // Initialize views
            showView('statsheet');
        });
    </script>
</body>
</html>
